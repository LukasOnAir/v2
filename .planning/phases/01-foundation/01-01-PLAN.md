---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - vite.config.ts
  - tsconfig.json
  - tsconfig.app.json
  - tsconfig.node.json
  - src/index.css
  - src/main.tsx
  - src/App.tsx
  - src/vite-env.d.ts
  - src/stores/uiStore.ts
  - src/hooks/useMediaQuery.ts
  - src/components/layout/Layout.tsx
  - src/components/layout/Sidebar.tsx
  - src/components/layout/Header.tsx
  - src/pages/TaxonomyPage.tsx
  - src/pages/RCTPage.tsx
  - src/pages/MatrixPage.tsx
  - index.html
autonomous: true

must_haves:
  truths:
    - "Application loads without errors on npm run dev"
    - "Dark theme with amber accents is visible immediately"
    - "Sidebar shows navigation items for Taxonomy, RCT, Matrix"
    - "Clicking sidebar items navigates between views"
    - "Sidebar collapses to icons on small screens or manual toggle"
    - "Role picker dropdown exists in header"
    - "Sidebar collapse state persists across browser refresh"
  artifacts:
    - path: "vite.config.ts"
      provides: "Vite + Tailwind v4 configuration"
      contains: "@tailwindcss/vite"
    - path: "src/index.css"
      provides: "Dark theme with amber accent colors"
      contains: "@theme"
    - path: "src/stores/uiStore.ts"
      provides: "UI state with LocalStorage persistence"
      exports: ["useUIStore"]
    - path: "src/components/layout/Layout.tsx"
      provides: "App shell with sidebar and header"
      min_lines: 20
    - path: "src/components/layout/Sidebar.tsx"
      provides: "Collapsible navigation sidebar"
      min_lines: 40
    - path: "src/components/layout/Header.tsx"
      provides: "Header with role picker"
      min_lines: 20
    - path: "src/pages/TaxonomyPage.tsx"
      provides: "Taxonomy view placeholder"
    - path: "src/pages/RCTPage.tsx"
      provides: "RCT view placeholder"
    - path: "src/pages/MatrixPage.tsx"
      provides: "Matrix view placeholder"
    - path: "src/App.tsx"
      provides: "React Router configuration"
      contains: "BrowserRouter"
  key_links:
    - from: "src/main.tsx"
      to: "src/App.tsx"
      via: "React root render"
      pattern: "createRoot.*render.*App"
    - from: "src/App.tsx"
      to: "src/components/layout/Layout.tsx"
      via: "Route element"
      pattern: "Route.*element.*Layout"
    - from: "src/components/layout/Sidebar.tsx"
      to: "react-router"
      via: "NavLink for navigation"
      pattern: "NavLink.*to="
    - from: "src/stores/uiStore.ts"
      to: "localStorage"
      via: "Zustand persist middleware"
      pattern: "persist.*storage"
    - from: "index.html"
      to: "dark mode"
      via: "dark class on html element"
      pattern: "class=\"dark\""
---

<objective>
Set up RiskGuard ERM project foundation: Vite + React 19 + TypeScript scaffolding with Tailwind CSS v4 dark theme, Zustand state management with LocalStorage persistence, and navigation between three placeholder views (Taxonomy, RCT, Matrix).

Purpose: Establish the application shell that all future features will build upon. This delivers a demoable dark-themed UI with working navigation and persistent state.

Output: Running React application with dark theme, collapsible sidebar, header with role picker, and three navigable views with appropriate empty states.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-CONTEXT.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Project Scaffolding and Theme Setup</name>
  <files>
    package.json
    vite.config.ts
    tsconfig.json
    tsconfig.app.json
    tsconfig.node.json
    src/index.css
    src/main.tsx
    src/vite-env.d.ts
    index.html
  </files>
  <action>
    1. Create Vite project with React + TypeScript template:
       ```bash
       npm create vite@latest . -- --template react-ts
       ```
       Note: Use `.` to scaffold in current directory since .planning already exists.

    2. Install dependencies:
       ```bash
       npm install zustand react-router lucide-react clsx
       npm install -D tailwindcss @tailwindcss/vite
       ```

    3. Update vite.config.ts to add Tailwind v4 plugin and @ alias:
       ```typescript
       import { defineConfig } from 'vite'
       import react from '@vitejs/plugin-react'
       import tailwindcss from '@tailwindcss/vite'

       export default defineConfig({
         plugins: [react(), tailwindcss()],
         resolve: {
           alias: {
             '@': '/src',
           },
         },
       })
       ```

    4. Replace src/index.css with Tailwind v4 theme configuration:
       - Use @import "tailwindcss" (not @tailwind directives)
       - Add @custom-variant dark (&:where(.dark, .dark *))
       - Define @theme with:
         - Surface colors: base (#0a0a0a), elevated (#121212), overlay (#1a1a1a), border (#27272a)
         - Amber accent palette (50-900) using oklch values from RESEARCH.md
         - Text colors: primary (#fafafa), secondary (#a1a1aa), muted (#71717a)
       - Add @layer base with html and body styling

    5. Update index.html to add `class="dark"` on the html element for dark-first mode.

    6. Update src/main.tsx to use StrictMode and import index.css.

    7. Delete default Vite template files: src/App.css, src/assets/react.svg (keep public/vite.svg for now).
  </action>
  <verify>
    Run `npm run dev` - application should start without errors.
    Visit http://localhost:5173 - page should show very dark background (#0a0a0a).
  </verify>
  <done>
    Vite dev server runs, page loads with dark background, no console errors.
  </done>
</task>

<task type="auto">
  <name>Task 2: State Management and Layout Components</name>
  <files>
    src/stores/uiStore.ts
    src/hooks/useMediaQuery.ts
    src/components/layout/Layout.tsx
    src/components/layout/Sidebar.tsx
    src/components/layout/Header.tsx
  </files>
  <action>
    1. Create src/stores/uiStore.ts with Zustand + persist middleware:
       - State: sidebarCollapsed (boolean), selectedRole ('risk-manager' | 'control-owner')
       - Actions: toggleSidebar, setSidebarCollapsed, setSelectedRole
       - Persist to localStorage with key 'riskguard-ui'
       - Use createJSONStorage(() => localStorage) for storage config

    2. Create src/hooks/useMediaQuery.ts custom hook:
       - Takes a media query string (e.g., '(min-width: 1024px)')
       - Returns boolean indicating if query matches
       - Uses window.matchMedia with proper cleanup

    3. Create src/components/layout/Header.tsx:
       - Fixed height header bar (h-14)
       - Left side: App title "RiskGuard ERM" in text-text-primary
       - Right side: Role picker dropdown using native select element
         - Options: "Risk Manager", "Control Owner"
         - Styled with bg-surface-elevated, text-text-primary, rounded border
       - Background: bg-surface-elevated with bottom border
       - Connect to uiStore for selectedRole state

    4. Create src/components/layout/Sidebar.tsx:
       - Fixed left sidebar, full height minus header
       - Width: w-64 expanded, w-16 collapsed
       - Collapse trigger: manual toggle button OR screen < 1024px (use useMediaQuery)
       - Navigation items using lucide-react icons:
         - Folders icon -> "Taxonomies" -> /taxonomy
         - Table icon -> "Risk Control Table" -> /rct
         - Grid3x3 icon -> "Matrix" -> /matrix
       - Use NavLink from react-router with active state styling (amber accent)
       - Smooth transition on collapse (transition-all duration-200)
       - Collapse toggle button at bottom of sidebar
       - When collapsed: show only icons, hide labels

    5. Create src/components/layout/Layout.tsx:
       - Flex container with Sidebar + main content area
       - Use Outlet from react-router for page content
       - Header at top, sidebar on left, content fills remaining space
       - Main content area has bg-surface-base and proper padding
  </action>
  <verify>
    Temporarily render Layout in App.tsx with a test div.
    Sidebar should show navigation items.
    Collapse toggle should work.
    Role picker should be in header.
    Refresh browser - sidebar state should persist.
  </verify>
  <done>
    Layout renders with header and collapsible sidebar.
    Sidebar collapse state persists in localStorage.
    Role selection persists in localStorage.
  </done>
</task>

<task type="auto">
  <name>Task 3: Page Components and Routing</name>
  <files>
    src/pages/TaxonomyPage.tsx
    src/pages/RCTPage.tsx
    src/pages/MatrixPage.tsx
    src/App.tsx
  </files>
  <action>
    1. Create src/pages/TaxonomyPage.tsx:
       - Title: "Taxonomies" in text-text-primary, text-2xl
       - Empty state card with bg-surface-elevated, rounded-lg, p-6
       - Text: "No risks or processes yet. Start building your taxonomies to get started."
       - This is a placeholder - real implementation comes in Phase 2

    2. Create src/pages/RCTPage.tsx:
       - Title: "Risk Control Table"
       - Dependency message card: "Build your Risk and Process taxonomies first to generate the Risk Control Table."
       - Link to /taxonomy: "Go to Taxonomies" styled as text-accent-500 hover:text-accent-400
       - Use Link from react-router

    3. Create src/pages/MatrixPage.tsx:
       - Title: "Risk-Process Matrix"
       - Dependency message card: "Complete risk assessments in the Risk Control Table first to see the aggregated matrix."
       - Link to /rct: "Go to Risk Control Table"

    4. Update src/App.tsx with React Router setup:
       ```typescript
       import { BrowserRouter, Routes, Route, Navigate } from 'react-router'
       import { Layout } from './components/layout/Layout'
       import { TaxonomyPage } from './pages/TaxonomyPage'
       import { RCTPage } from './pages/RCTPage'
       import { MatrixPage } from './pages/MatrixPage'

       function App() {
         return (
           <BrowserRouter>
             <Routes>
               <Route element={<Layout />}>
                 <Route index element={<Navigate to="/taxonomy" replace />} />
                 <Route path="taxonomy" element={<TaxonomyPage />} />
                 <Route path="rct" element={<RCTPage />} />
                 <Route path="matrix" element={<MatrixPage />} />
               </Route>
             </Routes>
           </BrowserRouter>
         )
       }

       export default App
       ```

    5. Ensure all navigation works:
       - Default route (/) redirects to /taxonomy
       - Sidebar NavLinks highlight correctly when active
       - Page transitions are instant (no animation between views per CONTEXT.md)
  </action>
  <verify>
    Run `npm run dev` and test:
    1. App loads at http://localhost:5173 and redirects to /taxonomy
    2. Click "Risk Control Table" in sidebar - navigates to /rct, shows dependency message with link
    3. Click "Matrix" in sidebar - navigates to /matrix, shows dependency message
    4. Click links in dependency messages - navigates correctly
    5. Sidebar highlights current route with amber accent
    6. Toggle sidebar collapse - persists after refresh
    7. Change role in dropdown - persists after refresh
  </verify>
  <done>
    All three views are navigable via sidebar.
    Active route is highlighted in sidebar.
    Dependency views show appropriate messages with working links.
    UI state (sidebar, role) persists across browser refresh.
    Application meets UI-01, UI-02, UI-03 requirements.
  </done>
</task>

</tasks>

<verification>
After all tasks complete, verify the phase success criteria:

1. **Dark theme with amber accents**: Background is very dark (#0a0a0a), amber used on active nav items and primary buttons
2. **Navigation between views**: Sidebar enables navigation to Taxonomy, RCT, Matrix views
3. **Responsive with smooth transitions**: Sidebar collapses on small screens, hover states work (scale 1.02x)
4. **LocalStorage persistence**: Sidebar collapse state and role selection survive browser refresh

Run final verification:
```bash
npm run dev
npm run build  # Should build without errors
```
</verification>

<success_criteria>
- [ ] `npm run dev` starts without errors
- [ ] `npm run build` completes successfully
- [ ] Application loads with dark theme (very dark background, amber accents)
- [ ] Sidebar shows three navigation items with lucide icons
- [ ] Clicking sidebar items navigates between views
- [ ] Sidebar collapses to icon-only on screens < 1024px or manual toggle
- [ ] Header shows "RiskGuard ERM" title and role picker
- [ ] Role picker changes between Risk Manager / Control Owner
- [ ] Taxonomy page shows empty state message
- [ ] RCT page shows dependency message linking to Taxonomy
- [ ] Matrix page shows dependency message linking to RCT
- [ ] Sidebar collapse state persists across refresh
- [ ] Selected role persists across refresh
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
