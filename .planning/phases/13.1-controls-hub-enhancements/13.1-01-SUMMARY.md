---
phase: 13.1-controls-hub-enhancements
plan: 01
subsystem: ui
tags: [radix-dialog, fuse.js, control-linking, rct]

# Dependency graph
requires:
  - phase: 13-controls-hub
    provides: controlsStore with controls and controlLinks arrays
provides:
  - Link Existing Control dialog in ControlPanel
  - Multi-link badge indicator on control cards
  - Risk ID display in link dialog header
affects: [13.1-02, 13.1-03]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - Fuse.js fuzzy search for control selection
    - Fragment wrapper for multiple Dialog.Root components

key-files:
  created: []
  modified:
    - src/components/rct/ControlPanel.tsx

key-decisions:
  - "Fragment wrapper for dual Dialog.Root (main panel + link dialog)"
  - "controlLinkCount computed per control card for badge display"

patterns-established:
  - "Link dialog pattern: searchable list with type and link count metadata"
  - "Multi-link badge shows 'X risks' when linkCount > 1"

# Metrics
duration: 4min
completed: 2026-01-22
---

# Phase 13.1 Plan 01: Link Existing Control Summary

**Link Existing Control dialog with fuzzy search and multi-link badge indicators in RCT ControlPanel**

## Performance

- **Duration:** 4 min
- **Started:** 2026-01-22T10:00:00Z
- **Completed:** 2026-01-22T10:04:00Z
- **Tasks:** 2
- **Files modified:** 1

## Accomplishments
- Added "Link Existing Control" button below Add Control input
- Implemented searchable dialog with Fuse.js fuzzy search
- Shows control type and link count in dialog list
- Displays risk ID in dialog header for context
- Added multi-link badge on controls linked to multiple rows

## Task Commits

Each task was committed atomically:

1. **Task 1: Add Link Existing Control dialog to ControlPanel** - `39eac40` (feat)
2. **Task 2: Add multi-link badge indicator to control cards** - `d9aeeb1` (feat)

## Files Created/Modified
- `src/components/rct/ControlPanel.tsx` - Added Link Existing dialog, search functionality, and multi-link badges

## Decisions Made
- Used fragment wrapper to support two Dialog.Root components in same return
- Compute linkCount per control from controlLinks array for badge display
- Reused existing Fuse.js pattern from other components for fuzzy search

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered

None.

## User Setup Required

None - no external service configuration required.

## Next Phase Readiness
- Link Existing Control functionality complete
- Ready for plan 02 (per-link score editing) and plan 03 (RCT netScore integration)

---
*Phase: 13.1-controls-hub-enhancements*
*Completed: 2026-01-22*
