---
phase: 13.1-controls-hub-enhancements
plan: 02
subsystem: ui
tags: [controls, react, zustand, per-link-scores]

# Dependency graph
requires:
  - phase: 13-controls-hub
    provides: ControlDetailPanel, ControlsTable components, controlsStore with updateLink
provides:
  - Per-link score editing UI in ControlDetailPanel
  - Visual expand indicator on ControlsTable name column
  - Risk ID display in linked risks section
affects: [13.1-03-RCT-integration]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - Per-link score override with fallback to control defaults
    - Group hover pattern for reveal-on-hover icons

key-files:
  created: []
  modified:
    - src/components/controls/ControlDetailPanel.tsx
    - src/components/controls/ControlsTable.tsx

key-decisions:
  - "Per-link scores fall back to control defaults when null"
  - "PanelRight icon chosen to indicate 'opens side panel' affordance"
  - "Override active indicator shows when any per-link score differs from control default"

patterns-established:
  - "Per-link override with fallback: link.value ?? control.value"
  - "Group hover reveal: opacity-0 group-hover:opacity-100 transition-opacity"

# Metrics
duration: 3min
completed: 2026-01-22
---

# Phase 13.1 Plan 02: Per-Link Score Editing Summary

**Per-link score editing UI with Net P/I dropdowns per linked risk, plus PanelRight expand indicator on ControlsTable names**

## Performance

- **Duration:** 3 min
- **Started:** 2026-01-22T09:00:00Z
- **Completed:** 2026-01-22T09:03:00Z
- **Tasks:** 2
- **Files modified:** 2

## Accomplishments

- Per-link score editing (Net P, Net I) available in ControlDetailPanel linked risks section
- Risk ID displayed below risk name for each linked risk
- "Override active" indicator and "Reset" button for link-specific score management
- PanelRight icon appears on hover over control names in ControlsTable

## Task Commits

Each task was committed atomically:

1. **Task 1: Add per-link score editing to ControlDetailPanel** - `fefdd11` (feat)
2. **Task 2: Add expand indicator to ControlsTable name column** - `24abf30` (feat)

**Plan metadata:** (this commit)

## Files Created/Modified

- `src/components/controls/ControlDetailPanel.tsx` - Added updateLink handler, per-link score editing UI with ScoreDropdown/HeatmapCell, risk ID display, Override active indicator, Reset button
- `src/components/controls/ControlsTable.tsx` - Added PanelRight icon import, hover-reveal expand indicator on name column

## Decisions Made

- Per-link scores use fallback pattern: display link.netProbability ?? control.netProbability
- PanelRight icon (from lucide-react) chosen over ChevronRight to indicate "opens side panel"
- Override active indicator shown when link.netProbability or link.netImpact is not null

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered

None

## User Setup Required

None - no external service configuration required.

## Next Phase Readiness

- Per-link score editing complete, ready for RCT integration
- ControlDetailPanel now fully supports risk-specific score overrides
- ControlsTable provides clear affordance for opening detail panel

---
*Phase: 13.1-controls-hub-enhancements*
*Completed: 2026-01-22*
