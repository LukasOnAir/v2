---
phase: 13.1-controls-hub-enhancements
plan: 03
type: execute
wave: 2
depends_on: ["13.1-01", "13.1-02"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "All 5 Phase 13.1 success criteria verified by user"
  artifacts: []
  key_links: []
---

<objective>
Human verification of complete Controls Hub Enhancements feature

Purpose: Confirm all Phase 13.1 success criteria are met through manual testing
Output: Verified phase completion, ready for STATE.md update
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/13.1-controls-hub-enhancements/13.1-01-SUMMARY.md
@.planning/phases/13.1-controls-hub-enhancements/13.1-02-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Controls Hub Enhancements feature:
1. "Link Existing Control" button and dialog in RCT ControlPanel
2. Per-link net score editing in Controls Hub ControlDetailPanel
3. Visual expand indicator (PanelRight icon) on control names in Controls Hub table
4. Risk ID shown in link dialogs and linked risks section
5. Multi-link badge indicator on control cards in RCT ControlPanel
  </what-built>
  <how-to-verify>
**Pre-requisite:** Ensure you have at least 2 risks in the Risk Taxonomy and 1 control already created.

**Test 1: Link Existing Control from RCT**
1. Run `npm run dev` and open http://localhost:5173
2. Navigate to Risk Control Table
3. Click any row to open the ControlPanel (slide-out from right)
4. Scroll to bottom of panel
5. Verify "Link Existing Control (X available)" button appears below the Add input
6. Click the button
7. Verify dialog opens with:
   - Search input at top
   - "Linking to: [riskId] - [riskName]" in header
   - List of available controls with name, type, and "Linked to X risks"
8. Search for a control by name (verify fuzzy search works)
9. Click a control to link it
10. Verify control appears in the ControlPanel list

**Test 2: Multi-Link Badge**
1. In ControlPanel, look at control cards
2. If a control is linked to multiple risks, verify badge shows "X risks"
3. If no multi-linked controls exist, link same control to another row and verify badge appears

**Test 3: Per-Link Score Editing**
1. Navigate to Controls Hub (/controls)
2. Hover over a control name - verify PanelRight icon appears
3. Click the control name to open ControlDetailPanel
4. In "Linked Risks" section, verify each linked risk shows:
   - Risk name
   - "ID: [riskId]"
   - Process name
   - Per-link Net P dropdown
   - Per-link Net I dropdown
   - Net Score heatmap cell
5. Change Net P or Net I for one link
6. Verify "Override active" indicator appears
7. Verify Net Score updates based on new P x I
8. Click "Reset" button
9. Verify override clears and values revert to control defaults

**Test 4: Cross-Verification**
1. Change per-link scores for a control on one risk
2. Navigate to RCT
3. Find the row that was modified
4. Verify the Net Score on that row reflects the per-link override
  </how-to-verify>
  <resume-signal>Type "verified" if all tests pass, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
All 5 Phase 13.1 success criteria from ROADMAP.md confirmed:
1. RCT "Add Control" offers option to link existing control from Controls Hub
2. Per-link net scores (P/I) can be edited independently in detail panel
3. Visual indicator (expand icon) on control names in Controls Hub table
4. Risk ID shown alongside name in link dialog
5. RCT shows indicator when control is linked to multiple risks
</verification>

<success_criteria>
- User confirms all 5 success criteria working correctly
- No blocking issues identified during verification
- Phase ready to be marked complete in ROADMAP.md
</success_criteria>

<output>
After completion, create `.planning/phases/13.1-controls-hub-enhancements/13.1-03-SUMMARY.md`
</output>
