---
phase: 19-mock-data-loader
plan: 02
type: execute
wave: 2
depends_on: ["19-01"]
files_modified:
  - src/components/layout/LoadMockDataDialog.tsx
  - src/components/layout/Header.tsx
autonomous: true

must_haves:
  truths:
    - "Header displays 'Load Mock Data' button visible to all roles"
    - "Clicking button opens confirmation dialog"
    - "Dialog warns about overwriting existing data"
    - "Confirming dialog populates all stores with mock data"
    - "Dialog closes after successful load"
  artifacts:
    - path: "src/components/layout/LoadMockDataDialog.tsx"
      provides: "Confirmation dialog for mock data loading"
      exports: ["LoadMockDataDialog"]
      min_lines: 50
    - path: "src/components/layout/Header.tsx"
      provides: "Header with mock data button"
      contains: "LoadMockDataDialog"
  key_links:
    - from: "Header.tsx"
      to: "LoadMockDataDialog.tsx"
      via: "component import and render"
      pattern: "LoadMockDataDialog"
    - from: "LoadMockDataDialog.tsx"
      to: "mockDataLoader.ts"
      via: "loadMockData import"
      pattern: "loadMockData"
---

<objective>
Integrate the mock data loader into the application header with a confirmation dialog.

Purpose: Provide one-click demo data loading accessible from the header for easy demonstration

Output: Updated Header component with "Load Mock Data" button and confirmation dialog
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-mock-data-loader/19-RESEARCH.md
@.planning/phases/19-mock-data-loader/19-01-SUMMARY.md

@src/components/layout/Header.tsx
@src/components/rct/AddColumnDialog.tsx (dialog pattern reference)
@src/utils/mockDataLoader.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create LoadMockDataDialog component</name>
  <files>src/components/layout/LoadMockDataDialog.tsx</files>
  <action>
Create `src/components/layout/LoadMockDataDialog.tsx` following the AddColumnDialog pattern:

```typescript
import * as Dialog from '@radix-ui/react-dialog'
import { AlertTriangle, X, Database } from 'lucide-react'
import { loadMockData } from '@/utils/mockDataLoader'
import { useState } from 'react'

interface LoadMockDataDialogProps {
  isOpen: boolean
  onClose: () => void
}

export function LoadMockDataDialog({ isOpen, onClose }: LoadMockDataDialogProps) {
  const [isLoading, setIsLoading] = useState(false)

  const handleConfirm = async () => {
    setIsLoading(true)
    try {
      // Small delay to show loading state
      await new Promise(resolve => setTimeout(resolve, 100))
      loadMockData()
      onClose()
    } finally {
      setIsLoading(false)
    }
  }

  return (
    <Dialog.Root open={isOpen} onOpenChange={(open) => !open && onClose()}>
      <Dialog.Portal>
        <Dialog.Overlay className="fixed inset-0 bg-black/60 z-40" />
        <Dialog.Content className="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[440px] bg-surface-elevated border border-surface-border rounded-lg shadow-xl z-50">
          {/* Header with warning icon */}
          <div className="flex items-center gap-3 p-4 border-b border-surface-border">
            <div className="p-2 bg-amber-500/10 rounded-lg">
              <AlertTriangle className="w-5 h-5 text-amber-500" />
            </div>
            <Dialog.Title className="text-lg font-semibold text-text-primary">
              Load Demo Data
            </Dialog.Title>
            <Dialog.Close asChild>
              <button
                className="ml-auto p-2 rounded-lg hover:bg-surface-overlay text-text-secondary hover:text-text-primary"
                disabled={isLoading}
              >
                <X size={20} />
              </button>
            </Dialog.Close>
          </div>

          {/* Warning message */}
          <div className="p-4 space-y-3">
            <p className="text-text-secondary">
              This will <span className="text-amber-500 font-medium">replace all existing data</span> with
              demonstration data. This action cannot be undone.
            </p>
            <p className="text-text-secondary text-sm">
              The demo data includes sample risks, processes, controls, tickets,
              comments, and other items to showcase all application features.
            </p>
            <div className="bg-surface-overlay rounded-lg p-3 text-sm">
              <p className="text-text-secondary font-medium mb-2">Demo data includes:</p>
              <ul className="text-text-muted space-y-1 list-disc list-inside">
                <li>Risk and Process taxonomies (5 levels)</li>
                <li>Risk scores with controls</li>
                <li>Control tests and remediation plans</li>
                <li>Tickets across all statuses</li>
                <li>Comments and knowledge base articles</li>
                <li>Pending approval changes</li>
              </ul>
            </div>
          </div>

          {/* Action buttons */}
          <div className="flex justify-end gap-2 p-4 border-t border-surface-border">
            <button
              onClick={onClose}
              disabled={isLoading}
              className="px-4 py-2 text-sm text-text-secondary hover:text-text-primary disabled:opacity-50"
            >
              Cancel
            </button>
            <button
              onClick={handleConfirm}
              disabled={isLoading}
              className="flex items-center gap-2 px-4 py-2 bg-amber-500 text-white rounded-lg text-sm font-medium hover:bg-amber-600 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              {isLoading ? (
                <>
                  <span className="animate-spin">...</span>
                  Loading...
                </>
              ) : (
                <>
                  <Database size={16} />
                  Load Demo Data
                </>
              )}
            </button>
          </div>
        </Dialog.Content>
      </Dialog.Portal>
    </Dialog.Root>
  )
}
```

**Key features:**
- Amber warning styling to indicate data overwrite
- Clear explanation of what will happen
- List of demo data included
- Loading state during population
- Follows existing Dialog pattern from AddColumnDialog
  </action>
  <verify>
1. File exists at `src/components/layout/LoadMockDataDialog.tsx`
2. TypeScript compiles: `npx tsc --noEmit`
3. Component exports `LoadMockDataDialog`
  </verify>
  <done>
- LoadMockDataDialog.tsx created with warning styling
- Dialog explains data overwrite consequence
- Loading state handled during mock data population
  </done>
</task>

<task type="auto">
  <name>Task 2: Add mock data button to Header</name>
  <files>src/components/layout/Header.tsx</files>
  <action>
Update `src/components/layout/Header.tsx` to add the Load Mock Data button and dialog:

1. Add imports:
```typescript
import { Database } from 'lucide-react'
import { useState } from 'react'
import { LoadMockDataDialog } from './LoadMockDataDialog'
```

2. Add state for dialog visibility inside the Header function:
```typescript
const [showMockDataDialog, setShowMockDataDialog] = useState(false)
```

3. Add button and dialog in the header's button group (before the role selector):
```tsx
{/* Load Mock Data button - visible to all roles */}
<button
  onClick={() => setShowMockDataDialog(true)}
  className="p-2 rounded-lg hover:bg-surface-overlay text-text-secondary hover:text-text-primary transition-colors"
  title="Load Demo Data"
>
  <Database className="w-5 h-5" />
</button>

{/* Mock Data Dialog */}
<LoadMockDataDialog
  isOpen={showMockDataDialog}
  onClose={() => setShowMockDataDialog(false)}
/>
```

**Button placement:** Put the button before the Manager bell icon and role selector so it's always visible.

**No role gating:** The button should be visible to all roles (Manager, Risk Manager, Control Owner) as it's a demo utility.
  </action>
  <verify>
1. TypeScript compiles: `npx tsc --noEmit`
2. Header imports LoadMockDataDialog
3. Header has Database icon button
4. Dialog state management in place
  </verify>
  <done>
- Header displays Database icon button for mock data loading
- Button visible to all roles
- Clicking opens LoadMockDataDialog
- Dialog state properly managed
  </done>
</task>

<task type="auto">
  <name>Task 3: Visual verification</name>
  <files>N/A</files>
  <action>
Start the development server and verify the feature works:

1. Run `npm run dev`
2. Navigate to any page (should see header)
3. Verify Database icon button appears in header (before role selector)
4. Click the button - dialog should open
5. Verify dialog shows:
   - Warning icon (amber triangle)
   - "Load Demo Data" title
   - Warning text about replacing data
   - List of demo data included
   - Cancel and "Load Demo Data" buttons
6. Click Cancel - dialog should close
7. Click Load Demo Data - should populate stores and close dialog
8. Navigate to different pages to verify data loaded:
   - Taxonomy page: Should show risk and process trees
   - RCT page: Should show rows with scores
   - Controls page: Should show controls
   - Tickets page: Should show tickets in Kanban
   - Approval page: Should show pending changes (as Manager)

Take note of any issues for the summary.
  </action>
  <verify>
1. Dev server starts without errors
2. Button visible in header
3. Dialog opens and closes correctly
4. Mock data populates all views
  </verify>
  <done>
- Mock data loader button visible in header
- Dialog provides clear warning about data overwrite
- Loading mock data populates all application stores
- Feature works end-to-end
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **Full application test:**
   - Start dev server: `npm run dev`
   - Click Load Demo Data button in header
   - Confirm in dialog
   - Verify data appears in all views

2. **All roles can access:**
   - Switch to each role (Manager, Risk Manager, Control Owner)
   - Verify button remains visible in header

3. **TypeScript compilation:**
   ```bash
   npx tsc --noEmit
   ```
</verification>

<success_criteria>
- Header contains Database icon button visible to all roles
- Clicking button opens confirmation dialog
- Dialog warns about overwriting existing data
- Dialog lists what demo data will be loaded
- Confirming loads mock data into all stores
- Dialog closes after successful load
- Data visible in Taxonomy, RCT, Controls, Tickets, Approval pages
</success_criteria>

<output>
After completion, create `.planning/phases/19-mock-data-loader/19-02-SUMMARY.md`
</output>
