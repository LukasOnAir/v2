---
phase: 29-demo-tenant-seed-data
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - supabase/seed-scripts/29-02-process-taxonomy.sql
autonomous: true

must_haves:
  truths:
    - "Process taxonomy has 6 L1 categories (Core Operations, Sales & Marketing, Support Functions, Procurement, Management, Compliance)"
    - "Each L1 category has 3-4 L2 subcategories"
    - "L2 categories have L3 children, some with L4/L5 for depth showcase"
    - "All nodes belong to tenant 5ea03edb-6e79-4b62-bd36-39f1963d0640"
    - "hierarchical_id auto-generated correctly (1, 1.1, 1.1.1, etc.)"
  artifacts:
    - path: "supabase/seed-scripts/29-02-process-taxonomy.sql"
      provides: "Process taxonomy seed SQL"
      contains: "INSERT INTO public.taxonomy_nodes"
  key_links:
    - from: "supabase/seed-scripts/29-02-process-taxonomy.sql"
      to: "public.taxonomy_nodes"
      via: "INSERT statements"
      pattern: "type = 'process'"
---

<objective>
Create SQL seed script for generic process taxonomy (L1-L5) in demo tenant.

Purpose: Populate the process taxonomy with generic business process categories that showcase all 5 hierarchy levels without being industry-specific.

Output: SQL script that can be executed via Supabase SQL Editor or psql to insert ~50-60 process taxonomy nodes.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@supabase/migrations/00013_taxonomy_nodes.sql
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create process taxonomy seed SQL script</name>
  <files>supabase/seed-scripts/29-02-process-taxonomy.sql</files>
  <action>
Create SQL seed script for process taxonomy. The script must:

1. Directory `supabase/seed-scripts/` should already exist from 29-01 (but create if missing)

2. Write SQL with this structure:
   - Header comment explaining purpose and tenant ID
   - Set tenant_id variable: `'5ea03edb-6e79-4b62-bd36-39f1963d0640'::uuid`
   - Delete any existing process taxonomy nodes for this tenant (clean slate)
   - Insert nodes in hierarchical order (parents before children)

3. Process taxonomy structure (generic, not industry-specific):

   **L1 Categories (6 total):**
   - Core Operations
   - Sales & Marketing
   - Support Functions
   - Procurement
   - Management
   - Compliance & Risk

   **L2 under Core Operations (4):**
   - Production/Service Delivery
   - Quality Assurance
   - Logistics & Distribution
   - Customer Service

   **L2 under Sales & Marketing (4):**
   - Business Development
   - Account Management
   - Marketing
   - Pricing & Contracts

   **L2 under Support Functions (4):**
   - Finance & Accounting
   - Human Resources
   - Information Technology
   - Facilities & Administration

   **L2 under Procurement (3):**
   - Sourcing
   - Purchasing
   - Vendor Management

   **L2 under Management (3):**
   - Strategic Planning
   - Performance Management
   - Project Management

   **L2 under Compliance & Risk (3):**
   - Regulatory Compliance
   - Internal Audit
   - Risk Management

   **L3 nodes (3-4 per L2, ~50 total):**
   Add specific process types under each L2. Examples:
   - Finance & Accounting -> Accounts Payable, Accounts Receivable, General Ledger, Financial Reporting
   - Human Resources -> Recruitment, Onboarding, Training, Compensation & Benefits
   - Information Technology -> Infrastructure, Applications, Security, Help Desk

   **L4/L5 nodes (select few to show depth):**
   Add 2-3 branches that go to L4 or L5 to showcase deep hierarchy:
   - Support Functions -> Finance & Accounting -> Financial Reporting -> Regulatory Filings -> Annual Report (L5)
   - Core Operations -> Production -> Manufacturing -> Assembly -> Final Assembly (L5)

4. SQL pattern for inserts using DO block:
   ```sql
   DO $$
   DECLARE
     tenant_id UUID := '5ea03edb-6e79-4b62-bd36-39f1963d0640';
     l1_core_ops UUID;
     l2_production UUID;
     -- etc
   BEGIN
     -- Delete existing process nodes for this tenant
     DELETE FROM public.taxonomy_nodes
     WHERE tenant_id = tenant_id AND type = 'process';

     INSERT INTO public.taxonomy_nodes (tenant_id, type, parent_id, name, description, sort_order)
     VALUES (tenant_id, 'process', NULL, 'Core Operations', 'Primary business operations', 1)
     RETURNING id INTO l1_core_ops;

     INSERT INTO public.taxonomy_nodes (tenant_id, type, parent_id, name, description, sort_order)
     VALUES (tenant_id, 'process', l1_core_ops, 'Production', 'Manufacturing or service delivery', 1)
     RETURNING id INTO l2_production;
     -- etc
   END $$;
   ```

5. Include meaningful descriptions for each node (1 sentence)

6. Set sort_order for proper sibling ordering (1, 2, 3, etc.)

7. Total nodes: ~55-65 process taxonomy nodes
  </action>
  <verify>
Run SQL in Supabase SQL Editor. Verify:
- `SELECT COUNT(*) FROM taxonomy_nodes WHERE tenant_id = '5ea03edb-6e79-4b62-bd36-39f1963d0640' AND type = 'process'` returns 55-65
- `SELECT hierarchical_id, name FROM taxonomy_nodes WHERE type = 'process' ORDER BY hierarchical_id` shows correct hierarchy
- L5 nodes exist (hierarchical_id like '%.%.%.%.%')
  </verify>
  <done>Process taxonomy seed script creates 55-65 nodes with proper L1-L5 hierarchy, auto-generated hierarchical_ids, and meaningful descriptions</done>
</task>

</tasks>

<verification>
- [ ] SQL script exists at supabase/seed-scripts/29-02-process-taxonomy.sql
- [ ] Script is syntactically valid SQL
- [ ] Uses hardcoded tenant_id for demo tenant
- [ ] Deletes existing process nodes before inserting (clean slate)
- [ ] Creates 6 L1 categories
- [ ] Creates ~21 L2 categories (3-4 per L1)
- [ ] Creates ~50 L3 categories (3-4 per L2)
- [ ] Creates 2-3 L4/L5 branches to showcase depth
- [ ] Each node has name, description, sort_order
</verification>

<success_criteria>
SQL script can be executed in Supabase SQL Editor to populate process taxonomy for demo tenant. Query shows hierarchical structure with proper hierarchical_ids generated by trigger.
</success_criteria>

<output>
After completion, create `.planning/phases/29-demo-tenant-seed-data/29-02-SUMMARY.md`
</output>
