---
phase: 30-matrix-resizable-headers
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/stores/matrixStore.ts
autonomous: true

must_haves:
  truths:
    - "Column widths can be stored per-column by ID"
    - "Row heights can be stored per-row by ID"
    - "Width/height values persist across browser sessions"
    - "Default values used when no custom size set"
  artifacts:
    - path: "src/stores/matrixStore.ts"
      provides: "columnWidths and rowHeights state maps with setters"
      contains: "columnWidths"
  key_links:
    - from: "columnWidths map"
      to: "localStorage persistence"
      via: "Zustand persist partialize"
      pattern: "columnWidths.*rowHeights"
---

<objective>
Add resizable header state to matrixStore

Purpose: Enable storing custom column widths and row heights per taxonomy item ID so they persist across sessions.
Output: Extended matrixStore with columnWidths/rowHeights maps and corresponding setter actions.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@src/stores/matrixStore.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add column/row size state and actions</name>
  <files>src/stores/matrixStore.ts</files>
  <action>
Add the following to MatrixState interface:
- `columnWidths: Record<string, number>` - Map of column item ID to width in pixels
- `rowHeights: Record<string, number>` - Map of row item ID to height in pixels
- `defaultColumnWidth: number` - Default width for columns (60)
- `defaultRowHeight: number` - Default height for rows (60)

Add actions:
- `setColumnWidth: (columnId: string, width: number) => void` - Set width for a specific column (min 40, max 400)
- `setRowHeight: (rowId: string, height: number) => void` - Set height for a specific row (min 30, max 200)
- `resetColumnWidth: (columnId: string) => void` - Remove custom width for column (reverts to default)
- `resetRowHeight: (rowId: string) => void` - Remove custom height for row (reverts to default)
- `resetAllSizes: () => void` - Clear all custom sizes

Initialize state:
- `columnWidths: {}`
- `rowHeights: {}`
- `defaultColumnWidth: 60`
- `defaultRowHeight: 60`

Implement actions using immer:
- setColumnWidth: clamp value between 40-400, set `state.columnWidths[columnId] = width`
- setRowHeight: clamp value between 30-200, set `state.rowHeights[rowId] = height`
- resetColumnWidth: `delete state.columnWidths[columnId]`
- resetRowHeight: `delete state.rowHeights[rowId]`
- resetAllSizes: `state.columnWidths = {}; state.rowHeights = {}`

Update partialize to include `columnWidths`, `rowHeights`, `defaultColumnWidth`, `defaultRowHeight` for localStorage persistence.
  </action>
  <verify>
Run TypeScript check: `npx tsc --noEmit`
Verify types compile without errors.
  </verify>
  <done>
matrixStore exports columnWidths, rowHeights, and all setter actions. Values persist in localStorage under 'riskguard-matrix' key.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes
2. Open browser console, run: `localStorage.getItem('riskguard-matrix')` - should show JSON with columnWidths, rowHeights fields
3. Import useMatrixStore in a test, verify all new actions exist
</verification>

<success_criteria>
- matrixStore TypeScript compiles without errors
- columnWidths and rowHeights are empty objects by default
- setColumnWidth/setRowHeight actions clamp values to valid ranges
- State is included in localStorage persistence
</success_criteria>

<output>
After completion, create `.planning/phases/30-matrix-resizable-headers/30-01-SUMMARY.md`
</output>
