---
phase: 39-create-request-for-information-document
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/content/rfiContent.ts
  - src/components/rfi/RFIDocument.tsx
  - src/components/rfi/RFIDialog.tsx
  - src/components/rfi/index.ts
  - src/components/layout/Header.tsx
autonomous: true

must_haves:
  truths:
    - "User can click Show RFI button in header next to RiskLytix logo"
    - "User sees PDF preview in dialog"
    - "User can download RFI as PDF file"
    - "PDF contains static risk management methodology content"
  artifacts:
    - path: "src/components/rfi/RFIDocument.tsx"
      provides: "PDF document definition with styled sections"
      exports: ["RFIDocument"]
    - path: "src/components/rfi/RFIDialog.tsx"
      provides: "Modal dialog with PDF preview and download"
      exports: ["RFIDialog"]
    - path: "src/content/rfiContent.ts"
      provides: "Static RFI text content structure"
      exports: ["rfiContent"]
  key_links:
    - from: "src/components/layout/Header.tsx"
      to: "src/components/rfi/RFIDialog.tsx"
      via: "lazy import and state toggle"
      pattern: "lazy.*RFIDialog"
    - from: "src/components/rfi/RFIDialog.tsx"
      to: "src/components/rfi/RFIDocument.tsx"
      via: "PDFViewer and PDFDownloadLink"
      pattern: "PDFViewer.*RFIDocument"
---

<objective>
Implement vendor RFI document generation with PDF export capability.

Purpose: Enable users to generate professional RFI documents for procurement and vendor assessment workflows. The RFI describes the organization's risk management methodology to help vendors understand requirements.

Output: "Show RFI" button in header that opens dialog with PDF preview and download functionality.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/39-create-request-for-information-document/39-RESEARCH.md
@src/components/layout/Header.tsx
@src/components/admin/InviteUserDialog.tsx
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install react-pdf and create RFI document component</name>
  <files>
    package.json
    src/content/rfiContent.ts
    src/components/rfi/RFIDocument.tsx
    src/components/rfi/index.ts
  </files>
  <action>
1. Install @react-pdf/renderer:
   ```bash
   npm install @react-pdf/renderer
   ```

2. Create `src/content/rfiContent.ts` with static RFI content:
   - Export `rfiContent` object with title, subtitle, and sections array
   - Include these sections:
     - Introduction/Purpose (what this RFI is for, how vendors should respond)
     - Company Overview (brief description, industry context)
     - Risk Management Framework (methodology overview, risk categories, control types)
     - Information Requested (vendor company info, risk capabilities, compliance certifications)
     - Response Format (how to structure response, contact info)
     - Evaluation Criteria (how responses will be assessed)
   - Keep content generic/placeholder (user can customize later)
   - Professional tone, 3-5 pages when rendered

3. Create `src/components/rfi/RFIDocument.tsx`:
   - Import Document, Page, Text, View, StyleSheet from @react-pdf/renderer
   - Use StyleSheet.create() for consistent styling (follow research patterns)
   - Styles: page padding 40, Helvetica font, professional color scheme (#1e293b titles, #334155 body, #64748b secondary)
   - Document metadata: title="Vendor RFI - RiskLytix ERM", author="RiskLytix"
   - Page size A4
   - Header with title and subtitle
   - Map over rfiContent.sections to render each section
   - Footer with "Generated by RiskLytix ERM | Confidential" positioned at bottom

4. Create `src/components/rfi/index.ts` barrel export:
   - Export RFIDocument from ./RFIDocument
   - Export RFIDialog from ./RFIDialog (will be created in Task 2)
  </action>
  <verify>
    Run `npm run build` - no TypeScript errors related to @react-pdf/renderer
    Check that src/components/rfi/RFIDocument.tsx exists and exports RFIDocument component
  </verify>
  <done>
    @react-pdf/renderer installed, RFI content defined, RFIDocument component renders PDF with all sections
  </done>
</task>

<task type="auto">
  <name>Task 2: Create RFI dialog and integrate in Header</name>
  <files>
    src/components/rfi/RFIDialog.tsx
    src/components/layout/Header.tsx
  </files>
  <action>
1. Create `src/components/rfi/RFIDialog.tsx`:
   - Import Dialog components from @radix-ui/react-dialog (follow InviteUserDialog pattern)
   - Import PDFViewer, PDFDownloadLink from @react-pdf/renderer
   - Import RFIDocument from ./RFIDocument
   - Import FileText, X, Download from lucide-react

   Props interface:
   ```typescript
   interface RFIDialogProps {
     open: boolean
     onOpenChange: (open: boolean) => void
   }
   ```

   Dialog structure:
   - Width: w-[800px] (wider than InviteUserDialog for readable PDF preview)
   - Height: max-h-[85vh] with overflow handling
   - Header: FileText icon + "Request for Information" title + close button
   - Content: PDFViewer with width="100%" height="500px" showToolbar={false}
   - Footer with actions:
     - Cancel button (closes dialog)
     - PDFDownloadLink wrapping Download button with filename `RiskLytix_Vendor_RFI.pdf`
   - Follow existing dialog styling patterns (bg-surface-elevated, border-surface-border, etc.)

2. Update `src/components/layout/Header.tsx`:
   - Add useState for showRFI dialog state
   - Use React.lazy() to lazily import RFIDialog (avoid bundle bloat - PDF library is ~500KB)
   - Add Suspense wrapper with null fallback

   Add "Show RFI" button AFTER the h1 title, BEFORE the flex container with role selector:
   ```tsx
   <header className="...">
     <div className="flex items-center gap-3">
       <h1 className="text-lg font-semibold text-text-primary">
         RiskLytix ERM
       </h1>
       <button
         onClick={() => setShowRFI(true)}
         className="px-3 py-1.5 text-sm bg-surface-overlay hover:bg-surface-elevated border border-surface-border rounded-md flex items-center gap-1.5 text-text-secondary hover:text-text-primary transition-colors"
       >
         <FileText className="w-4 h-4" />
         Show RFI
       </button>
     </div>

     <div className="flex items-center gap-4">
       {/* existing content: approval bell, role selector, tester selector, profile, logout */}
     </div>
   </header>
   ```

   Add lazy-loaded dialog at end of header component:
   ```tsx
   <Suspense fallback={null}>
     {showRFI && (
       <RFIDialog open={showRFI} onOpenChange={setShowRFI} />
     )}
   </Suspense>
   ```

3. Import FileText from lucide-react in Header.tsx
  </action>
  <verify>
    Run `npm run dev` and verify:
    - "Show RFI" button appears in header next to RiskLytix logo
    - Clicking button opens dialog with PDF preview
    - Download button saves PDF file
    Run `npm run build` - no errors
  </verify>
  <done>
    RFI dialog shows PDF preview, download works, button positioned correctly in header next to logo
  </done>
</task>

</tasks>

<verification>
1. Build passes: `npm run build` completes without errors
2. Button placement: "Show RFI" button visible in header, positioned next to RiskLytix ERM title
3. Dialog opens: Clicking button opens modal with PDF preview
4. PDF content: Preview shows professional RFI document with all sections (Introduction, Company Overview, Risk Framework, Information Requested, Response Format, Evaluation Criteria)
5. Download works: Clicking download saves RiskLytix_Vendor_RFI.pdf to user's downloads
6. Lazy loading: PDF library only loaded when dialog is opened (check Network tab - @react-pdf chunk loads on button click, not on page load)
</verification>

<success_criteria>
- User clicks "Show RFI" button in header and sees PDF preview in dialog
- User can download RFI as PDF file with professional formatting
- PDF contains 6 sections of static risk management methodology content
- Bundle impact minimized via lazy loading (main bundle size unchanged)
- Dialog follows existing project patterns (Radix UI, Tailwind styling)
</success_criteria>

<output>
After completion, create `.planning/phases/39-create-request-for-information-document/39-01-SUMMARY.md`
</output>
